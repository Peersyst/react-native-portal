{"version":3,"names":["React","memo","useCallback","useEffect","useMemo","useRef","nanoid","usePortal","useContextBridge","IGNORED_CONTEXTS_DISPLAY_NAMES","PortalComponent","name","_providedName","hostName","handleOnMount","_providedHandleOnMount","handleOnUnmount","_providedHandleOnUnmount","handleOnUpdate","_providedHandleOnUpdate","children","addPortal","addUpdatePortal","removePortal","ContextBridge","childrenWithContextBridge","createElement","key","handleOnMountRef","handleOnUnmountRef","handleOnUpdateRef","current","_handleOnMountRef$cur","call","_handleOnUnmountRef$c","undefined","_handleOnUpdateRef$cu","Portal","displayName"],"sources":["Portal.tsx"],"sourcesContent":["import React, { memo, useCallback, useEffect, useMemo, useRef } from 'react';\nimport { nanoid } from 'nanoid/non-secure';\nimport { usePortal } from '../../hooks/usePortal';\nimport type { PortalProps } from './types';\nimport { useContextBridge } from 'its-fine';\n\nconst IGNORED_CONTEXTS_DISPLAY_NAMES = [\n  'TextAncestorContext',\n  'RootTagContext',\n  'ScrollViewContext',\n  'VirtualizedListContext',\n];\n\nconst PortalComponent = ({\n  name: _providedName,\n  hostName,\n  handleOnMount: _providedHandleOnMount,\n  handleOnUnmount: _providedHandleOnUnmount,\n  handleOnUpdate: _providedHandleOnUpdate,\n  children,\n}: PortalProps) => {\n  //#region hooks\n  const { addPortal: addUpdatePortal, removePortal } = usePortal(hostName);\n  //#endregion\n\n  //#region variables\n  const name = useMemo(() => _providedName || nanoid(), [_providedName]);\n  // Get context bridge to forward contexts to the portal\n  const ContextBridge = useContextBridge(IGNORED_CONTEXTS_DISPLAY_NAMES);\n  const childrenWithContextBridge = useMemo(() => {\n    return <ContextBridge key={name}>{children}</ContextBridge>;\n  }, [name, children]);\n  //#endregion\n\n  //#region refs\n  const handleOnMountRef = useRef<Function>();\n  const handleOnUnmountRef = useRef<Function>();\n  const handleOnUpdateRef = useRef<Function>();\n  //#endregion\n\n  //#region callbacks\n  const handleOnMount = useCallback(() => {\n    if (_providedHandleOnMount) {\n      _providedHandleOnMount(() =>\n        addUpdatePortal(name, childrenWithContextBridge)\n      );\n    } else {\n      addUpdatePortal(name, childrenWithContextBridge);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [_providedHandleOnMount, addUpdatePortal]);\n  handleOnMountRef.current = handleOnMount;\n\n  const handleOnUnmount = useCallback(() => {\n    if (_providedHandleOnUnmount) {\n      _providedHandleOnUnmount(() => removePortal(name));\n    } else {\n      removePortal(name);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [_providedHandleOnUnmount, removePortal]);\n  handleOnUnmountRef.current = handleOnUnmount;\n\n  const handleOnUpdate = useCallback(() => {\n    if (_providedHandleOnUpdate) {\n      _providedHandleOnUpdate(() =>\n        addUpdatePortal(name, childrenWithContextBridge)\n      );\n    } else {\n      addUpdatePortal(name, childrenWithContextBridge);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [_providedHandleOnUpdate, addUpdatePortal, childrenWithContextBridge]);\n  handleOnUpdateRef.current = handleOnUpdate;\n  //#endregion\n\n  //#region effects\n  useEffect(() => {\n    handleOnMountRef.current?.();\n    return () => {\n      handleOnUnmountRef.current?.();\n\n      // remove callbacks refs\n      handleOnMountRef.current = undefined;\n      handleOnUnmountRef.current = undefined;\n      handleOnUpdateRef.current = undefined;\n    };\n  }, []);\n  useEffect(() => {\n    handleOnUpdateRef.current?.();\n  }, [childrenWithContextBridge]);\n  //#endregion\n\n  return null;\n};\n\nexport const Portal = memo(PortalComponent);\nPortal.displayName = 'Portal';\n"],"mappings":"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","ignoreList":[]}