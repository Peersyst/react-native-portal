{"version":3,"names":["_react","_interopRequireWildcard","require","_nonSecure","_usePortal","_itsFine","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","IGNORED_CONTEXTS_DISPLAY_NAMES","PortalComponent","name","_providedName","hostName","handleOnMount","_providedHandleOnMount","handleOnUnmount","_providedHandleOnUnmount","handleOnUpdate","_providedHandleOnUpdate","children","addPortal","addUpdatePortal","removePortal","usePortal","useMemo","nanoid","ContextBridge","useContextBridge","childrenWithContextBridge","createElement","key","handleOnMountRef","useRef","handleOnUnmountRef","handleOnUpdateRef","useCallback","current","useEffect","_handleOnMountRef$cur","_handleOnUnmountRef$c","undefined","_handleOnUpdateRef$cu","Portal","exports","memo","displayName"],"sources":["Portal.tsx"],"sourcesContent":["import React, { memo, useCallback, useEffect, useMemo, useRef } from 'react';\nimport { nanoid } from 'nanoid/non-secure';\nimport { usePortal } from '../../hooks/usePortal';\nimport type { PortalProps } from './types';\nimport { useContextBridge } from 'its-fine';\n\nconst IGNORED_CONTEXTS_DISPLAY_NAMES = [\n  'TextAncestorContext',\n  'RootTagContext',\n  'ScrollViewContext',\n  'VirtualizedListContext',\n];\n\nconst PortalComponent = ({\n  name: _providedName,\n  hostName,\n  handleOnMount: _providedHandleOnMount,\n  handleOnUnmount: _providedHandleOnUnmount,\n  handleOnUpdate: _providedHandleOnUpdate,\n  children,\n}: PortalProps) => {\n  //#region hooks\n  const { addPortal: addUpdatePortal, removePortal } = usePortal(hostName);\n  //#endregion\n\n  //#region variables\n  const name = useMemo(() => _providedName || nanoid(), [_providedName]);\n  // Get context bridge to forward contexts to the portal\n  const ContextBridge = useContextBridge(IGNORED_CONTEXTS_DISPLAY_NAMES);\n  const childrenWithContextBridge = useMemo(() => {\n    return <ContextBridge key={name}>{children}</ContextBridge>;\n  }, [name, children]);\n  //#endregion\n\n  //#region refs\n  const handleOnMountRef = useRef<Function>();\n  const handleOnUnmountRef = useRef<Function>();\n  const handleOnUpdateRef = useRef<Function>();\n  //#endregion\n\n  //#region callbacks\n  const handleOnMount = useCallback(() => {\n    if (_providedHandleOnMount) {\n      _providedHandleOnMount(() =>\n        addUpdatePortal(name, childrenWithContextBridge)\n      );\n    } else {\n      addUpdatePortal(name, childrenWithContextBridge);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [_providedHandleOnMount, addUpdatePortal]);\n  handleOnMountRef.current = handleOnMount;\n\n  const handleOnUnmount = useCallback(() => {\n    if (_providedHandleOnUnmount) {\n      _providedHandleOnUnmount(() => removePortal(name));\n    } else {\n      removePortal(name);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [_providedHandleOnUnmount, removePortal]);\n  handleOnUnmountRef.current = handleOnUnmount;\n\n  const handleOnUpdate = useCallback(() => {\n    if (_providedHandleOnUpdate) {\n      _providedHandleOnUpdate(() =>\n        addUpdatePortal(name, childrenWithContextBridge)\n      );\n    } else {\n      addUpdatePortal(name, childrenWithContextBridge);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [_providedHandleOnUpdate, addUpdatePortal, childrenWithContextBridge]);\n  handleOnUpdateRef.current = handleOnUpdate;\n  //#endregion\n\n  //#region effects\n  useEffect(() => {\n    handleOnMountRef.current?.();\n    return () => {\n      handleOnUnmountRef.current?.();\n\n      // remove callbacks refs\n      handleOnMountRef.current = undefined;\n      handleOnUnmountRef.current = undefined;\n      handleOnUpdateRef.current = undefined;\n    };\n  }, []);\n  useEffect(() => {\n    handleOnUpdateRef.current?.();\n  }, [childrenWithContextBridge]);\n  //#endregion\n\n  return null;\n};\n\nexport const Portal = memo(PortalComponent);\nPortal.displayName = 'Portal';\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,uBAAA,CAAAC,OAAA;AACA,IAAAC,UAAA,GAAAD,OAAA;AACA,IAAAE,UAAA,GAAAF,OAAA;AAEA,IAAAG,QAAA,GAAAH,OAAA;AAA4C,SAAAD,wBAAAK,CAAA,EAAAC,CAAA,6BAAAC,OAAA,MAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAP,uBAAA,YAAAA,CAAAK,CAAA,EAAAC,CAAA,SAAAA,CAAA,IAAAD,CAAA,IAAAA,CAAA,CAAAK,UAAA,SAAAL,CAAA,MAAAM,CAAA,EAAAC,CAAA,EAAAC,CAAA,KAAAC,SAAA,QAAAC,OAAA,EAAAV,CAAA,iBAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,SAAAQ,CAAA,MAAAF,CAAA,GAAAL,CAAA,GAAAG,CAAA,GAAAD,CAAA,QAAAG,CAAA,CAAAK,GAAA,CAAAX,CAAA,UAAAM,CAAA,CAAAM,GAAA,CAAAZ,CAAA,GAAAM,CAAA,CAAAO,GAAA,CAAAb,CAAA,EAAAQ,CAAA,gBAAAP,CAAA,IAAAD,CAAA,gBAAAC,CAAA,OAAAa,cAAA,CAAAC,IAAA,CAAAf,CAAA,EAAAC,CAAA,OAAAM,CAAA,IAAAD,CAAA,GAAAU,MAAA,CAAAC,cAAA,KAAAD,MAAA,CAAAE,wBAAA,CAAAlB,CAAA,EAAAC,CAAA,OAAAM,CAAA,CAAAK,GAAA,IAAAL,CAAA,CAAAM,GAAA,IAAAP,CAAA,CAAAE,CAAA,EAAAP,CAAA,EAAAM,CAAA,IAAAC,CAAA,CAAAP,CAAA,IAAAD,CAAA,CAAAC,CAAA,WAAAO,CAAA,KAAAR,CAAA,EAAAC,CAAA;AAE5C,MAAMkB,8BAA8B,GAAG,CACrC,qBAAqB,EACrB,gBAAgB,EAChB,mBAAmB,EACnB,wBAAwB,CACzB;AAED,MAAMC,eAAe,GAAGA,CAAC;EACvBC,IAAI,EAAEC,aAAa;EACnBC,QAAQ;EACRC,aAAa,EAAEC,sBAAsB;EACrCC,eAAe,EAAEC,wBAAwB;EACzCC,cAAc,EAAEC,uBAAuB;EACvCC;AACW,CAAC,KAAK;EACjB;EACA,MAAM;IAAEC,SAAS,EAAEC,eAAe;IAAEC;EAAa,CAAC,GAAG,IAAAC,oBAAS,EAACX,QAAQ,CAAC;EACxE;;EAEA;EACA,MAAMF,IAAI,GAAG,IAAAc,cAAO,EAAC,MAAMb,aAAa,IAAI,IAAAc,iBAAM,EAAC,CAAC,EAAE,CAACd,aAAa,CAAC,CAAC;EACtE;EACA,MAAMe,aAAa,GAAG,IAAAC,yBAAgB,EAACnB,8BAA8B,CAAC;EACtE,MAAMoB,yBAAyB,GAAG,IAAAJ,cAAO,EAAC,MAAM;IAC9C,oBAAOzC,MAAA,CAAAgB,OAAA,CAAA8B,aAAA,CAACH,aAAa;MAACI,GAAG,EAAEpB;IAAK,GAAES,QAAwB,CAAC;EAC7D,CAAC,EAAE,CAACT,IAAI,EAAES,QAAQ,CAAC,CAAC;EACpB;;EAEA;EACA,MAAMY,gBAAgB,GAAG,IAAAC,aAAM,EAAW,CAAC;EAC3C,MAAMC,kBAAkB,GAAG,IAAAD,aAAM,EAAW,CAAC;EAC7C,MAAME,iBAAiB,GAAG,IAAAF,aAAM,EAAW,CAAC;EAC5C;;EAEA;EACA,MAAMnB,aAAa,GAAG,IAAAsB,kBAAW,EAAC,MAAM;IACtC,IAAIrB,sBAAsB,EAAE;MAC1BA,sBAAsB,CAAC,MACrBO,eAAe,CAACX,IAAI,EAAEkB,yBAAyB,CACjD,CAAC;IACH,CAAC,MAAM;MACLP,eAAe,CAACX,IAAI,EAAEkB,yBAAyB,CAAC;IAClD;IACA;EACF,CAAC,EAAE,CAACd,sBAAsB,EAAEO,eAAe,CAAC,CAAC;EAC7CU,gBAAgB,CAACK,OAAO,GAAGvB,aAAa;EAExC,MAAME,eAAe,GAAG,IAAAoB,kBAAW,EAAC,MAAM;IACxC,IAAInB,wBAAwB,EAAE;MAC5BA,wBAAwB,CAAC,MAAMM,YAAY,CAACZ,IAAI,CAAC,CAAC;IACpD,CAAC,MAAM;MACLY,YAAY,CAACZ,IAAI,CAAC;IACpB;IACA;EACF,CAAC,EAAE,CAACM,wBAAwB,EAAEM,YAAY,CAAC,CAAC;EAC5CW,kBAAkB,CAACG,OAAO,GAAGrB,eAAe;EAE5C,MAAME,cAAc,GAAG,IAAAkB,kBAAW,EAAC,MAAM;IACvC,IAAIjB,uBAAuB,EAAE;MAC3BA,uBAAuB,CAAC,MACtBG,eAAe,CAACX,IAAI,EAAEkB,yBAAyB,CACjD,CAAC;IACH,CAAC,MAAM;MACLP,eAAe,CAACX,IAAI,EAAEkB,yBAAyB,CAAC;IAClD;IACA;EACF,CAAC,EAAE,CAACV,uBAAuB,EAAEG,eAAe,EAAEO,yBAAyB,CAAC,CAAC;EACzEM,iBAAiB,CAACE,OAAO,GAAGnB,cAAc;EAC1C;;EAEA;EACA,IAAAoB,gBAAS,EAAC,MAAM;IAAA,IAAAC,qBAAA;IACd,CAAAA,qBAAA,GAAAP,gBAAgB,CAACK,OAAO,cAAAE,qBAAA,eAAxBA,qBAAA,CAAAlC,IAAA,CAAA2B,gBAA2B,CAAC;IAC5B,OAAO,MAAM;MAAA,IAAAQ,qBAAA;MACX,CAAAA,qBAAA,GAAAN,kBAAkB,CAACG,OAAO,cAAAG,qBAAA,eAA1BA,qBAAA,CAAAnC,IAAA,CAAA6B,kBAA6B,CAAC;;MAE9B;MACAF,gBAAgB,CAACK,OAAO,GAAGI,SAAS;MACpCP,kBAAkB,CAACG,OAAO,GAAGI,SAAS;MACtCN,iBAAiB,CAACE,OAAO,GAAGI,SAAS;IACvC,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EACN,IAAAH,gBAAS,EAAC,MAAM;IAAA,IAAAI,qBAAA;IACd,CAAAA,qBAAA,GAAAP,iBAAiB,CAACE,OAAO,cAAAK,qBAAA,eAAzBA,qBAAA,CAAArC,IAAA,CAAA8B,iBAA4B,CAAC;EAC/B,CAAC,EAAE,CAACN,yBAAyB,CAAC,CAAC;EAC/B;;EAEA,OAAO,IAAI;AACb,CAAC;AAEM,MAAMc,MAAM,GAAAC,OAAA,CAAAD,MAAA,gBAAG,IAAAE,WAAI,EAACnC,eAAe,CAAC;AAC3CiC,MAAM,CAACG,WAAW,GAAG,QAAQ","ignoreList":[]}